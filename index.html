<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Uploader une image et générer un lien</title>
  <style>
    body { background: #121212; color: white; font-family: sans-serif; text-align: center; padding: 40px; }
    input, button { margin: 10px; padding: 10px; }
    #result { margin-top: 20px; word-break: break-all; }
  </style>
</head>
<body>

  <h1>Uploader une image</h1>
  <input type="file" id="fileInput" accept="image/*"><br>
  <input type="text" id="imageName" placeholder="Nom du fichier (ex: photo.jpg)">
  <button onclick="uploadImage()">Générer le lien</button>

  <div id="result"></div>

  <script>
    async function uploadImage() {
      const fileInput = document.getElementById("fileInput");
      const imageName = document.getElementById("imageName").value || "uploaded.jpg";
      const resultDiv = document.getElementById("result");

      if (!fileInput.files[0]) {
        resultDiv.textContent = "Veuillez choisir une image.";
        return;
      }

      const file = fileInput.files[0];
      const reader = new FileReader();

      reader.onload = async function () {
        const base64Image = reader.result.split(',')[1]; // Supprime le prefix "data:image/...;base64,"

        const formData = new URLSearchParams();
        formData.append("image", base64Image);
        formData.append("name", imageName);

        resultDiv.textContent = "Téléversement en cours...";

        try {
          const response = await fetch("https://upload-images-hosting-get-url.p.rapidapi.com/upload", {
            method: "POST",
            headers: {
              "Content-Type": "application/x-www-form-urlencoded",
              "x-rapidapi-host": "upload-images-hosting-get-url.p.rapidapi.com",
              "x-rapidapi-key": "ab42dda446mshde4ba65d25b85fdp13b83ejsn3965c0519b7d"
            },
            body: formData
          });

          const data = await response.json();
          if (data.url) {
            resultDiv.innerHTML = `<p>Lien de l'image :</p><a href="${data.url}" target="_blank">${data.url}</a>`;
          } else {
            resultDiv.textContent = "Erreur : aucun lien retourné.";
          }
        } catch (error) {
          console.error(error);
          resultDiv.textContent = "Erreur lors de l'upload.";
        }
      };

      reader.readAsDataURL(file);
    }
  </script>

</body>
</html> 
