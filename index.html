<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Uploader une image - ImgURL API</title>
  <style>
    body { background-color: #1c1c1c; color: white; font-family: sans-serif; text-align: center; padding: 40px; }
    input, button { margin: 10px; padding: 10px; }
    #result { margin-top: 20px; word-break: break-word; }
  </style>
</head>
<body>

  <h1>Uploader une image</h1>
  <input type="file" id="fileInput" accept="image/*"><br>
  <button onclick="uploadImage()">Envoyer</button>

  <div id="result"></div>

  <script>
    async function uploadImage() {
      const fileInput = document.getElementById("fileInput");
      const resultDiv = document.getElementById("result");

      if (!fileInput.files[0]) {
        resultDiv.textContent = "Veuillez sélectionner une image.";
        return;
      }

      const file = fileInput.files[0];
      const reader = new FileReader();

      reader.onload = async function () {
        const base64Image = reader.result.split(',')[1]; // Enlève "data:image/png;base64,"

        const formData = new URLSearchParams();
        formData.append("image", base64Image);

        resultDiv.textContent = "Téléversement en cours...";

        try {
          const response = await fetch("https://imgurl.p.rapidapi.com/upload", {
            method: "POST",
            headers: {
              "Content-Type": "application/x-www-form-urlencoded",
              "x-rapidapi-host": "imgurl.p.rapidapi.com",
              "x-rapidapi-key": "ab42dda446mshde4ba65d25b85fdp13b83ejsn3965c0519b7d"
            },
            body: formData
          });

          const data = await response.json();

          if (data && data.link) {
            resultDiv.innerHTML = `<p>Lien de l'image :</p><a href="${data.link}" target="_blank">${data.link}</a>`;
          } else {
            resultDiv.textContent = "Erreur : réponse invalide.";
            console.log(data);
          }
        } catch (error) {
          console.error(error);
          resultDiv.textContent = "Erreur lors de l'envoi.";
        }
      };

      reader.readAsDataURL(file);
    }
  </script>

</body>
</html>
